is_osx() {
    if [ "$(uname)" = "Darwin" ]; then
        return 0
    fi

    return 1
}

# Open a link (probably works for file paths as well)
# in the systems default browser
open_link() {
    if is_osx; then
        open "$1"
    else
        xdg-open "$1"
    fi
}

# Launch an http server in the current directory
# and optionally open it in the default browser
server() {
    local port="8000"

    if [ "$1" != "--no-browser" ] && [ "$1" != "-n" ]; then
        (sleep 1 && open_link "http://localhost:${port}/") &
    fi

    if command_exists python3; then
        python3 -m http.server "$port"
    else
        python -m SimpleHTTPServer "$port"
    fi
}

# Install helpers to finish setting up the shell.
# TODO: move this functionality to a bootstrap script

df_install_rvm() {
    \curl -sSL https://get.rvm.io | bash -s stable --ignore-dotfiles
}

df_install_nvm() {
    _CURRENT_DIR="$PWD"

    git clone https://github.com/creationix/nvm.git "${HOME}/.nvm"
    cd "${HOME}/.nvm"
    git checkout $(git describe --abbrev=0 --tags)

    cd "$_CURRENT_DIR"
    unset $_CURRENT_DIR
}

df_install_homebrew() {
    ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
}

df_install_zsh() {
    _CURRENT_DIR="$PWD"

    # Manually install oh-my-zsh
    cd "$HOME"
    git clone https://github.com/tarjoilija/zgen.git "${HOME}/.zgen"

    cd "$_CURRENT_DIR"
    unset $_CURRENT_DIR
}

df_install() {
    df_install_rvm
    df_install_nvm
    df_install_zsh
    if is_osx; then
        df_install_homebrew
    fi
}
