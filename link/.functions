# Open a link (probably works for file paths as well)
# in the systems default browser
function open_link() {
    if [ "$(uname)" = "Darwin" ]; then
        open "$1"
    else
        xdg-open "$1"
    fi
}

# Launch an http server in the current directory
# and optionally open it in the default browser
function server() {
    local port="8000"

    if [ "$1" != "--no-browser" ] && [ "$1" != "-n" ]; then
        (sleep 1 && open_link "http://localhost:${port}/") &
    fi

    if command -v python3 >/dev/null; then
        python3 -m http.server "$port"
    else
        python -m SimpleHTTPServer "$port"
    fi
}

# Adapted from https://gist.github.com/SlexAxton/4989674
function gifify() {
    local OPTIND
    local gif_width="480"
    while getopts ":w:s:d:" opt; do
        case "${opt}" in
            w)
                gif_width="${OPTARG}"
                ;;
            s)
                ffmpeg_start="${OPTARG}"
                ;;
            d)
                ffmpeg_duration="${OPTARG}"
                ;;
            *)
                echo "Not a flag"
                exit 1
                ;;
        esac
    done

    shift $(( OPTIND - 1))

    if [[ -n "$1" ]]; then
        ffmpeg -i "${1}" -ss "${ffmpeg_start}" -t "${ffmpeg_duration}" -r 10 -f image2pipe -vcodec ppm - | convert +dither -coalesce -layers Optimize -resize "${gif_width}" - "${1}".gif
    else
        echo "proper usage: gifify <input.ext>. You DO need to include extension."
    fi
}

function install_rvm() {
    \curl -L https://get.rvm.io | bash -s stable --ruby --ignore-dotfiles
}

function install_homebrew() {
    ruby -e "$(curl -fsSL https://raw.github.com/mxcl/homebrew/go)"
}
