#!/usr/bin/env sh

command_exists() (
    if alias "$1" >/dev/null 2>&1; then
        unalias "$1" >/dev/null 2>&1
    fi

    command -v "$1" >/dev/null 2>&1
)

safe_source() {
    if [ -f "$1" ]; then
        . "$1"
    fi
}

# before is intended as a local override for certain env vars
# and additional paths
safe_source "$HOME/.before"

. "$HOME/.shellconfig/exports"
. "$HOME/.shellconfig/path"
. "$HOME/.shellconfig/functions"
. "$HOME/.shellconfig/aliases"
. "$HOME/.shellconfig/tmux"

# For URXvt
if command_exists xrdb; then
    xrdb -merge "${HOME}/.Xresources" >/dev/null 2>&1
fi

# SSH Agent Setup
if command_exists gnome-keyring-daemon; then
    if [ -n "$DESKTOP_SESSION" ];then
        eval $(gnome-keyring-daemon --start)
        export SSH_AUTH_SOCK
    fi
fi

# Third-party Scripts
safe_source "$HOME/.nvm/nvm.sh"

# Use .after for things that you want to set after everything else
safe_source "$HOME/.after"

unset -f safe_source
